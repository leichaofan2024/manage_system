<div style = "margin-top:20px;">
  <div class="col-md-12" style = "margin-bottom:20px;">
    <% if params[:year].present? %>
      <%= link_to("<< 返回",group_attendances_path(:year => params[:year],:month => params[:month]))%>
    <% else %>
      <%= link_to("<< 返回",group_attendances_path) %>
    <% end %>
  </div>

  <div class="card">
    <div class="col-md-12" style="overflow: auto">
      <table id="example" class="table table-bordered table-strip">
        <thead>
          <tr>
            <th>工资号</th>

            <th>姓名</th>
            <th>班组</th>
            <th>车间</th>
            <% @vacation_code_hash.values.each do |name| %>
              <th><%= name %></th>
            <% end %>
          </tr>
        </thead>
          <tbody data-behavior='sortable'>
            <% @employees.each do |employee| %>
              <% attendance_count = AttendanceCount.find_by(:employee_id => employee.id, :month => @month, :year => @year)%>
              <tr>
                <td><%= employee.sal_number %></td>

                <td><%= employee.name %></td>
                <td><%= Group.current.find_by(:id => employee.group).name %></td>
                <td><%= Workshop.current.find_by(:id => employee.workshop).name %></td>
                <% @vacation_code_hash.keys.each do |code| %>
                  <% if attendance_count.present? %>
                    <% if attendance_count.attributes[code] == 0%>
                      <td></td>
                    <% else %>
                      <td><%= attendance_count.attributes[code]%></td>
                    <% end %>
                  <% else %>
                   <td></td>
                  <% end %>
                <% end %>
              </tr>
            <% end %>
         </tbody>
      </table>
    </div>
  </div>
</div>
