<div class="contentpanel">
  <div class="wage-navbar">
    <%= link_to "返回",high_speed_rail_stuffs_path,class:"nav-item" %>
    <ul class="nav nav-pills">
      <li class="nav-item">
        <a href="/high_speed_rail_stuffs/new_head">人员公式</a>
      </li>
      <li class="nav-item">
        <a href="/high_speed_rail_stuffs/new_head_wage">金额公式</a>
      </li>
    </ul>
  </div>
  <%= form_tag create_head_high_speed_rail_stuffs_path,method: :post do %>
  <div class="panel">
    <div class="panel-heading">
      <h4>新增表头(人员公式)</h4>
    </div>
    <div class="panel-body">
      <div class="form-group">
        <%= label_tag "表头名称："%>
        <%= hidden_field_tag "high_head_name",@high_speed_stuff %>
        <%= text_field_tag "head_name"  %>
      </div>

      <div class="form-group">
        <span>
        <%= label_tag "除以人数：" %>
        <select class="" name= "per_capita">
        <option disabled selected value>--请选择--</option>
        <% HighSpeedRailStuffHead.pluck(:head_name).each do |head_name| %>
        <option value="<%= head_name %>"><%= head_name %></option>
        <% end %>
        </select>
        </span>
      </div>

      <div class="form-group">
        <%= label_tag "人数计算公式："%>
        <span>
        <%= label_tag "期末人数" %>
        <%= check_box_tag "final_period","yes" %>
        </span>
        <span>
        <%= label_tag "平均人数" %>
        <%= check_box_tag "average","yes" %>
        </span>
      </div>
        <%= render "common/new_head"%>
    </div>
  </div>
  <% end %>
</div>





<script type="text/javascript">

  function selCity()
          {
            var arr = gon.employee_array;
            var textarr = gon.employee_key;
            var selNode = document.getElementById("selid");
            var subselNode = document.getElementById("subselid");
            var index = selNode.selectedIndex;
            var citys = arr[index];
            var keys = textarr[index];

            var selectNode = document.createElement("select");
            subselNode.appendChild(selectNode);
            selectNode.name = citys[0]+"[]";
            selectNode.id = citys[0];

            var selectBlock = document.getElementById(citys[0]);

            for(var i=0; i<citys[1].length; i++)
            {
              var optionNode = document.createElement("option");
              optionNode.value = citys[1][i];
              optionNode.innerText = citys[1][i];
              selectBlock.appendChild(optionNode);
            };

            selectBlock.multiple = true;
            selectBlock.setAttribute("style", "width: 80%;");

            var newDiv = document.createElement("div");
            var newContent = document.createTextNode(keys);
            newDiv.appendChild(newContent); //add the text node to the newly created div.
            // add the newly created element and its content into the DOM
            $("#"+citys[0]).before(newDiv);

            $("#"+citys[0]).select2( {
              theme: "bootstrap"
            });
          };

          $("#selid").select2();
</script>
