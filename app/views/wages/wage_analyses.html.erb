<div class="contentpanel">
  <div class="panel">
    <div class="panel-heading">
      <h4>各职务收入对比</h4>
      <%= form_tag wage_analyses_wages_path,method: :get do%>
          <div class="form-group">
              <li>
                <span>时间搜索:</span>
                <% if params[:start_time].present? && params[:end_time].present? %>
                  <%= text_field_tag :start_time,params[:start_time]%> ~
                  <%= text_field_tag :end_time,params[:end_time] %>
                <% else %>
                  <%= text_field_tag :start_time,""%> ~
                  <%= text_field_tag :end_time,""%>
                <% end %>
              </li>
              <!-- <div class='col-md-5'>
        <div class="form-group">
            <div class='input-group date' id='datetimepicker6'>
                <input type='text' class="form-control" />
                <span class="input-group-addon">
                    <span class="glyphicon glyphicon-calendar"></span>
                </span>
            </div>
        </div>
    </div> -->
    <!-- <div class='col-md-5'>
        <div class="form-group">
            <div class='input-group date' id='datetimepicker7'>
                <input type='text' class="form-control" />
                <span class="input-group-addon">
                    <span class="glyphicon glyphicon-calendar"></span>
                </span>
            </div>
        </div>
    </div> -->
              <li>
                <%= label_tag :时间段： %>
                <select name="timeselect">
                  <% ["月","季度","年"].each do |time| %>
                    <% if params[:time] == time %>
                      <option value="<%= time %>" selected><%= time %></option>
                    <% else %>
                      <option value="<%= time %>"><%= time %></option>
                    <% end %>
                  <% end %>
                </select>
              </li>

              <li>
                  <%= check_box_tag(:phase_contrast,1)%>
                  <%= label_tag "与上一年同期相比" %>
              </li>
          </div>
          <div class="row">
              <ul class="nav nav-tabs" id="click-prop">
                <li class="nav-item">
                  <a class="nav-link" data-toggle="tab" href="#home" >车间部门</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" id="profile-tab" data-toggle="tab" href="#profile" role="tab" aria-controls="profile" aria-selected="false">级别</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" id="contact-tab" data-toggle="tab" href="#contact" role="tab" aria-controls="contact" aria-selected="false">职务</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" id="group-tab" data-toggle="tab" role="tab" aria-controls="group" aria-selected="false" href="#group" >工种</a>
                </li>
              </ul>

              <div class="tab-content" id="myTabContent">
                <div class="tab-pane" id="home">
                  <div class="col-md-12">
                    <input id="check_all" type="checkbox" />
                    <label for="check_all">全选</label>
                  </div>

                  <% Workshop.current.each do |workshop| %>
                    <div class="col-md-3 col-sm-4">
                      <%= check_box_tag("workshop[]",workshop.id,false)%>
                      <%= label_tag workshop.name%>
                    </div>
                  <% end %>
                </div>
                <div class="tab-pane fade" id="profile">
                  <div class="col-md-12">
                    <input id="check_grade" type="checkbox" name="grade_compare" value="1"/>
                    <label>比较干部和工人</label>
                  </div>
                  <% Employee.pluck(:grade).uniq.compact.delete_if{|x| x==""}.each do |grade| %>
                  <div class="col-md-3 col-sm-4">
                    <%= check_box_tag("grade[]",grade,false,class:"grade_checked")%>
                    <%= label_tag grade%>
                  </div>
                  <% end %>
                </div>
                <div class="tab-pane fade" id="contact">
                  <div class="col-md-12">
                    <input id="check_duty" type="checkbox" />
                    <label for="check_duty">全选</label>
                  </div>
                  <% Employee.pluck(:duty).uniq.each do |duty| %>
                  <div class="col-md-3 col-sm-4">
                    <% if duty == nil %>
                    <%= check_box_tag("duty[]","未填写",false)%>
                    <%= label_tag "未填写"%>
                    <% else %>
                    <%= check_box_tag("duty[]",duty,false)%>
                    <%= label_tag duty %>
                    <% end %>
                  </div>
                  <% end %>
                </div>
                <div class="tab-pane fade" id="group">
                  <div class="col-md-12">
                    <input id="check_worktype" type="checkbox" />
                    <label for="check_worktype">全选</label>
                  </div>
                  <% Employee.pluck(:work_type).uniq.each do |work_type| %>
                  <div class="col-md-3 col-sm-4">
                    <% if work_type == nil %>
                      <%= check_box_tag("work_type[]","未填写",false)%>
                      <%= label_tag "未填写"%>
                    <% else %>
                      <%= check_box_tag("work_type[]",work_type,false)%>
                      <%= label_tag work_type%>
                    <% end %>
                  </div>
                  <% end %>
                </div>
              </div>
          </div>
          <div class="toolbar" style="margin-top:10px;">
              <%= submit_tag "提交",:data => {:disable_with => "计算中..."}%>
          </div>
        <% end%>
    </div><!--panel-heading-->
  </div>

  <div class="panel">
    <div class="panel-body">
      <table class="table overflow-y">
        <thead>
          <tr>
            <% if params[:timeselect].blank? %>
            <th>请选择筛选条件</th>
            <% else %>
            <th>类别</th>
            <% end %>
            <% @time_form_header.each do |head_time|  %>
            <th>
              <%= head_time %>
            </th>
            <% end %>
          </tr>
        </thead>
        <tbody>
          <% @category_income_compare.each do |key,value| %>
          <tr>
            <td>
              <%= key %>
            </td>
            <% value.each do |table_value| %>
            <td>
              <%= table_value%>
            </td>
            <% end %>
          </tr>
          <% end %>
        </tbody>
      </table>
    </div>
  </div>
</div>



<script type="text/javascript">
  function GetCheckData(){
    return $("#myTabContent input[type='checkbox']");
  }
  $("#click-prop").click(function(){
    GetCheckData().prop("checked",false);
  })
  $("#check_all").click(function(){
    if($(this).is(":checked")){
      $("#home input[type='checkbox']").prop("checked",true);
    }else {
      $("#home input[type='checkbox']").prop("checked",false);
    }
  })
  $("#check_duty").click(function(){
    if($(this).is(":checked")){
      $("#contact input[type='checkbox']").prop("checked",true);
    }else {
      $("#contact input[type='checkbox']").prop("checked",false);
    }
  })
  $("#check_worktype").click(function(){
    if($(this).is(":checked")){
      $("#group input[type='checkbox']").prop("checked",true);
    }else {
      $("#group input[type='checkbox']").prop("checked",false);
    }
  })
  $("#check_grade").click(function(){
    if($(this).is(":checked")){
      $("input.grade_checked").attr("disabled", true);
    }else {
      $("#profile input[type='checkbox']").removeAttr("disabled");
    }
  });
//   function btnlink(){
//     var input[type='checkbox'] = this;
//     if(typeof this == "undefined"){
//       ("#check-button").attr("disabled", true);
//     }
//
// }

  $(function () {
      $('#datetimepicker6').datetimepicker();
      $('#datetimepicker7').datetimepicker({
          useCurrent: false //Important! See issue #1075
      });
      $("#datetimepicker6").on("dp.change", function (e) {
          $('#datetimepicker7').data("DateTimePicker").minDate(e.date);
      });
      $("#datetimepicker7").on("dp.change", function (e) {
          $('#datetimepicker6').data("DateTimePicker").maxDate(e.date);
      });
  });
</script>
